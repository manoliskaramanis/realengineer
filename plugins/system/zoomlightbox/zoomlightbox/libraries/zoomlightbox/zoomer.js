(function(b){function a(h,e){var g,j;var c=h;var d={smallArea:"small",largeArea:"large",clone:true,edge:30,lenteWidth:250,lenteHeight:250,ratio:2};b(h).wrap('<div class="small"/>');var i=b(h).parent();b(i).wrap('<div class="zoom"/>');var f=b(h).parent().parent();h=f;this.$wrap=b(h).addClass("az-wrap").wrapInner('<span class="az-wrap-inner"/>');this.wrap=h;this.$wrap.data("zoomer",this);this.init=function(){this.options=j=b.extend({},d,e);this.state=true;this.$small=this.$wrap.find("."+j.smallArea);this.$large=this.$wrap.find("."+j.largeArea);if(j.clone){g=this.$small.clone().removeClass(j.smallArea).addClass(j.largeArea);g=b(g).find("input").remove().end();if(this.$large.length){this.$large.html(g.html())}else{this.$small.after(g);this.$large=this.$wrap.find("."+j.largeArea)}}var k=this;setTimeout(function(){k.$small.wrapInner('<span class="az-small-inner"/>');k.smallDim=[b(c).width(),b(c).height()];k.largeDim=[k.smallDim[0]*j.ratio,k.smallDim[1]*j.ratio];var o=parseInt(b(c).css("font-size"))*j.ratio;var n=parseInt(b(c).css("font-size"));var m=0;var l="normal";if(c.nodeName!="IMG"){m=(n-(180/n))*(3*(n/8));if(b.browser.safari===undefined&&n<16){if(b.browser.msie&&parseInt(b.browser.version)>=9){m-=35/n*30}else{m-=20/n*30}}var l=parseInt(b(c).css("line-height"));if(!isNaN(l)){l*=j.ratio;l+="px"}}b(b(k.$large).children().get(0)).css({width:k.largeDim[0]+m,height:k.largeDim[1],"font-size":o,"line-height":l});if(c.nodeName==="IMG"){if(parseInt(b(c).attr("width"))>0){b(b(k.$large).children().get(0)).removeAttr("width")}if(parseInt(b(c).attr("height"))>0){b(b(k.$large).children().get(0)).removeAttr("height")}}k.$large.addClass("az-large").wrap('<div class="az-zoom"></div>');k.$small.addClass("az-small");k.$zoom=k.$wrap.find(".az-zoom");k.ratio=[k.smallDim[0]===0?1:k.largeDim[0]/k.smallDim[0],k.smallDim[1]===0?1:k.largeDim[1]/k.smallDim[1]];k.$inner=k.$wrap.find(".az-wrap-inner");k.zoomDim=k.last=[j.lenteWidth,j.lenteHeight];k.smallOffset=[k.$small.offset().left-k.$inner.position().left,k.$small.offset().top];k.$inner.bind("mouseenter.zlZoomer",function(){if(k.state&&k.zoomEnabled){k.$zoom.fadeIn(100);b("body").removeClass("zoomer_active")}}).bind("mouseleave.zlZoomer",function(){if(k.state&&k.zoomEnabled){k.timer=setTimeout(function(){if(k.$zoom.is(".az-windowed")){k.hideZoom()}},200);b("body").addClass("zoomer_active")}}).bind("mousemove.zlZoomer",function(p){if(k.state&&k.zoomEnabled){clearTimeout(k.timer);k.zoomAt(p.pageX-k.smallOffset[0],p.pageY-k.smallOffset[1])}});k.showSmall()},200)};this.showSmall=function(){this.state=true;this.$small.show();this.$zoom.removeClass("az-expanded").addClass("az-windowed az-zoom").css({width:this.zoomDim[0],height:this.zoomDim[1]})};this.zoomAt=function(s,o,n){var r=(n?n[0]||0:0)||this.last[0],p=(n?n[1]||n[0]||0:0)||this.last[1],k=r/2,q=p/2,m=j.edge||k*0.66,l=j.edge||q*0.66;this.last=[r,p];if((s<-m)||(s>this.smallDim[0]+m)||(o<-l)||(o>this.smallDim[1]+l)){this.hideZoom();return}else{this.$zoom.fadeIn(100)}this.$zoom.css({left:s-k,top:o-q,width:r,height:p});this.$large.css({left:-(s-k/2)*this.ratio[0],top:-(o-q/2)*this.ratio[1]})};this.hideZoom=function(){this.last=this.zoomDim;this.$zoom.fadeOut(100)};this.init()}a.prototype.zoomEnabled=false;b.fn.zlZoomer=function(d,c,f,e){return this.each(function(){var g=b(this).data("zoomer");if((typeof(d)).match("object")&&!g){new a(this,d)}})};b.fn.getZoomer=function(){return this.data("zoomer")};b.setZoomer=function(c){a.prototype.zoomEnabled=c}})(jQuery);